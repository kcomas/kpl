
#include "def.h"

static const char *op_reg_strs[] = {
    "R8",
    "R16",
    "R32",
    "R64",
    "XMM",
    "MM",
    "M8",
    "M16",
    "M32",
    "M64",
    "M128",
    "DSP8",
    "DSP32",
    "I8",
    "I16",
    "I32",
    "I64",
    "SCALE1",
    "SCALE2",
    "SCALE4",
    "SCALE8",
    "REL8",
    "REL32",
    "0",
    "1",
    "2",
    "3",
    "4",
    "5",
    "6",
    "7",
};

const char *x64_op_reg_str(uint32_t bit_idx) {
    if (bit_idx > X64_OP_REG_MAX_BIT)
        return "X64 INVALID OP REG";
    return op_reg_strs[bit_idx];
}

static const char *pfx_flag_strs[] = {
    "LOCK",
    "REP",
    "REPNZ",
    "REPNE",
    "REPZ",
    "REPE",
    "PREFIX",
    "REX",
    "0F",
    "PLUSR",
    "OPCODE",
    "MODRRM",
    "INVALID",
    "END",
};

const char *x64_pfx_flag_str(uint16_t bit_idx) {
    if (bit_idx > X64_PFX_FLAG_MAX_BIT)
        return "X64 INVALID PREFIX FLAG";
    return pfx_flag_strs[bit_idx];
}

extern inline int8_t x64_reg_id(x64_reg reg);

extern inline bool x64_reg_is_upper(x64_reg reg);

const char *reg_strs[] = {
    "RAX",
    "RCX",
    "RDX",
    "RBX",
    "RSP",
    "RBP",
    "RDI",
    "RSI",
    "R8",
    "R9",
    "R10",
    "R11",
    "R12",
    "R13",
    "R14",
    "R15",
    "XMM0",
    "XMM1",
    "XMM2",
    "XMM3",
    "XMM4",
    "XMM5",
    "XMM6",
    "XMM7",
    "XMM8",
    "XMM9",
    "XMM10",
    "XMM11",
    "XMM12",
    "XMM13",
    "XMM14",
    "XMM15",
    "MM0",
    "MM1",
    "MM2",
    "MM3",
    "MM4",
    "MM5",
    "MM6",
    "MM7",
    "RIP",
    "_"
};

const char *x64_reg_str(x64_reg reg) {
    if (reg < X64_REG(_))
        return reg_strs[reg];
    return "X64 INVALID REG";
}

const char *mne_strs[] = {
    "INVALID",
    "0F",
    "64NULL",
    "OPERAND_SIZE",
    "WAIT",
    "LOCK",
    "REPNZ",
    "REPNE",
    "REP",
    "REPZ",
    "REPE",
    "_",
    "REX",
    "REX_B",
    "REX_X",
    "REX_XB",
    "REX_R",
    "REX_RB",
    "REX_RX",
    "REX_RXB",
    "REX_W",
    "REX_WB",
    "REX_WX",
    "REX_WXB",
    "REX_WR",
    "REX_WRB",
    "REX_WRX",
    "REX_WRXB",
    "_",
    "ADD",
    "OR",
    "ADC",
    "SBB",
    "AND",
    "SUB",
    "XOR",
    "CMP",
    "PUSH",
    "POP",
    "MOVSXD",
    "IMUL",
    "INS",
    "OUTS",
    "JO",
    "JNO",
    "JB",
    "JNAE",
    "JC",
    "JNB",
    "JAE",
    "JNC",
    "JZ",
    "JE",
    "JNZ",
    "JNE",
    "JBE",
    "JNA",
    "JNBE",
    "JA",
    "JS",
    "JNS",
    "JP",
    "JPE",
    "JNP",
    "JPO",
    "JL",
    "JNGE",
    "JNL",
    "JGE",
    "JLE",
    "JNG",
    "JNLE",
    "JG",
    "TEST",
    "XCHG",
    "MOV",
    "LEA",
    "NOP",
    "PAUSE",
    "CBW",
    "CWDE",
    "CDQE",
    "CWD",
    "CDQ",
    "CQO",
    "PUSHF",
    "POPF",
    "MOVS",
    "CMPS",
    "STOS",
    "LODS",
    "SCAS",
    "ROL",
    "ROR",
    "RCL",
    "RCR",
    "SHL",
    "SHR",
    "SAL",
    "SAR",
    "RET",
    "ENTER",
    "LEAVE",
    "RETF",
    "INT3",
    "INT",
    "LOOPNZ",
    "LOOPNE",
    "LOOPZ",
    "LOOPE",
    "LOOP",
    "JECXZ",
    "JRCXZ",
    "IN",
    "OUT",
    "CALL",
    "JMP",
    "INT1",
    "HLT",
    "CMC",
    "NOT",
    "NEG",
    "MUL",
    "DIV",
    "IDIV",
    "CLC",
    "STC",
    "CLI",
    "STI",
    "CLD",
    "STD",
    "INC",
    "DEC",
    "MOVUPS",
    "MOVSS",
    "MOVUPD",
    "MOVSD",
    "MOVHLPS",
    "MOVLPS",
    "MOVLPD",
    "MOVDDUP",
    "MOVSLDUP",
    "UNPCKLPS",
    "UNPCKLPD",
    "UNPCKHPS",
    "UNPCKHPD",
    "MOVLHPS",
    "MOVHPS",
    "MOVHPD",
    "MOVSHDUP",
    "MOVAPS",
    "MOVAPD",
    "CVTPI2PS",
    "CVTSI2SS",
    "CVTPI2PD",
    "CVTSI2SD",
    "MOVNTPS",
    "MOVNTPD",
    "CVTTPS2PI",
    "CVTTSS2SI",
    "CVTTPD2PI",
    "CVTTSD2SI",
    "CVTPS2PI",
    "CVTSS2SI",
    "CVTPD2PI",
    "CVTSD2SI",
    "UCOMISS",
    "UCOMISD",
    "COMISS",
    "COMISD",
    "MOVBE",
    "CRC32",
    "ROUNDPS",
    "ROUNDPD",
    "ROUNDSS",
    "ROUNDSD",
    "BLENDPS",
    "BLENDPD",
    "PBLENDW",
    "PALIGNR",
    "PEXTRB",
    "PEXTRW",
    "PEXTRD",
    "PEXTRQ",
    "EXTRACTPS",
    "PINSRB",
    "INSERTPS",
    "PINSRD",
    "PINSRQ",
    "DPPS",
    "DPPD",
    "MPSADBW",
    "PCMPESTRM",
    "PCMPESTRI",
    "PCMPISTRM",
    "PCMPISTRI",
    "CMOVO",
    "CMOVNO",
    "CMOVB",
    "CMOVNAE",
    "CMOVC",
    "CMOVNB",
    "CMOVAE",
    "CMOVNC",
    "CMOVZ",
    "CMOVE",
    "CMOVNZ",
    "CMOVNE",
    "CMOVBE",
    "CMOVNA",
    "CMOVNBE",
    "CMOVA",
    "CMOVS",
    "CMOVNS",
    "CMOVP",
    "CMOVPE",
    "CMOVNP",
    "CMOVPO",
    "CMOVL",
    "CMOVNGE",
    "CMOVNL",
    "CMOVGE",
    "CMOVLE",
    "CMOVNG",
    "CMOVNLE",
    "CMOVG",
    "MOVMSKPS",
    "MOVMSKPD",
    "SQRTPS",
    "SQRTSS",
    "SQRTPD",
    "SQRTSD",
    "RSQRTPS",
    "RSQRTSS",
    "RCPPS",
    "RCPSS",
    "ANDPS",
    "ANDPD",
    "ANDNPS",
    "ANDNPD",
    "ORPS",
    "ORPD",
    "XORPS",
    "XORPD",
    "ADDPS",
    "ADDSS",
    "ADDPD",
    "ADDSD",
    "MULPS",
    "MULSS",
    "MULPD",
    "MULSD",
    "CVTPS2PD",
    "CVTPD2PS",
    "CVTSS2SD",
    "CVTSD2SS",
    "CVTDQ2PS",
    "CVTPS2DQ",
    "CVTTPS2DQ",
    "SUBPS",
    "SUBSS",
    "SUBPD",
    "SUBSD",
    "MINPS",
    "MINSS",
    "MINPD",
    "MINSD",
    "DIVPS",
    "DIVSS",
    "DIVPD",
    "DIVSD",
    "MAXPS",
    "MAXSS",
    "MAXPD",
    "MAXSD",
    "PUNPCKLBW",
    "PUNPCKLWD",
    "PUNPCKLDQ",
    "PACKSSWB",
    "PCMPGTB",
    "PCMPGTW",
    "PCMPGTD",
    "PACKUSWB",
    "PUNPCKHBW",
    "PUNPCKHWD",
    "PUNPCKHDQ",
    "PACKSSDW",
    "PUNPCKLQDQ",
    "PUNPCKHQDQ",
    "MOVD",
    "MOVQ",
    "MOVDQA",
    "MOVDQU",
    "PSHUFW",
    "PSHUFLW",
    "PSHUFHW",
    "PSHUFD",
    "PSRLW",
    "PSRAW",
    "PSLLW",
    "PSRLD",
    "PSRAD",
    "PSLLD",
    "PSRLQ",
    "PSRLDQ",
    "PSLLQ",
    "PSLLDQ",
    "PCMPEQB",
    "PCMPEQW",
    "PCMPEQD",
    "EMMS",
    "HADDPD",
    "HADDPS",
    "HSUBPD",
    "HSUBPS",
    "SETO",
    "SETNO",
    "SETB",
    "SETNAE",
    "SETC",
    "SETNB",
    "SETAE",
    "SETNC",
    "SETZ",
    "SETE",
    "SETNZ",
    "SETNE",
    "SETBE",
    "SETNA",
    "SETNBE",
    "SETA",
    "SETS",
    "SETNS",
    "SETP",
    "SETPE",
    "SETNP",
    "SETPO",
    "SETL",
    "SETNGE",
    "SETNL",
    "SETGE",
    "SETLE",
    "SETNG",
    "SETNLE",
    "SETG",
    "BT",
    "SHLD",
    "BTS",
    "SHRD",
    "CMPXCHG",
    "BTR",
    "MOVZX",
    "POPCNT",
    "BTC",
    "BSE",
    "BSF",
    "BSR",
    "MOVSX",
    "XADD",
    "CMPPS",
    "CMPSS",
    "CMPPD",
    "CMPSD",
    "MOVNTI",
    "PINSRW",
    "SHUFPS",
    "SHUFPD",
    "CMPXCHG8B",
    "CMPXCHG16B",
    "BSWAP",
    "ADDSUBPD",
    "ADDSUBPS",
    "PADDQ",
    "PMULLW",
    "MOVQ2DQ",
    "MOVDQ2Q",
    "PMOVMSKB",
    "PSUBUSB",
    "PSUBUSW",
    "PMINUB",
    "PAND",
    "PADDUSB",
    "PADDUSW",
    "PMAXUB",
    "PANDN",
    "PAVGB",
    "PAVGW",
    "PMULHUW",
    "PMULHW",
    "CVTPD2DQ",
    "CVTTPD2DQ",
    "CVTDQ2PD",
    "MOVNTQ",
    "MOVNTDQ",
    "PSUBSB",
    "PSUBSW",
    "PMINSW",
    "POR",
    "PADDSB",
    "PADDSW",
    "PMAXSW",
    "PXOR",
    "LDDQU",
    "PMULUDQ",
    "PMADDWD",
    "PSADBW",
    "MASKMOVQ",
    "MASKMOVDQU",
    "PSUBB",
    "PSUBW",
    "PSUBD",
    "PSUBQ",
    "PADDB",
    "PADDW",
    "PADDD",
    "_"
};

const char *x64_mne_str(x64_mne mne) {
    if (mne < X64_MNE_INST(_))
        return mne_strs[mne];
    return "X64 INVALID MNE";
}
