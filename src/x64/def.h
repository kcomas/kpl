
#pragma once

#include "../type/type.h"

#define X64_OP(NAME) X64_OP_##NAME

#define X64_OP_REG(NAME) X64_OP_REG_##NAME

typedef enum [[gnu::packed]] {
    X64_OP(R8)      = 1 << 0,
    X64_OP(R16)     = 1 << 1,
    X64_OP(R32)     = 1 << 2,
    X64_OP(R64)     = 1 << 3,
    X64_OP(XMM)     = 1 << 4,
    X64_OP(MM)      = 1 << 5,
    X64_OP(M8)      = 1 << 6,
    X64_OP(M16)     = 1 << 7,
    X64_OP(M32)     = 1 << 8,
    X64_OP(M64)     = 1 << 9,
    X64_OP(M128)    = 1 << 10,
    X64_OP(DSP8)    = 1 << 11,
    X64_OP(DSP32)   = 1 << 12,
    X64_OP(I8)      = 1 << 13,
    X64_OP(I16)     = 1 << 14,
    X64_OP(I32)     = 1 << 15,
    X64_OP(I64)     = 1 << 16,
    X64_OP(SCALE1)  = 1 << 17,
    X64_OP(SCALE2)  = 1 << 18,
    X64_OP(SCALE4)  = 1 << 19,
    X64_OP(SCALE8)  = 1 << 20,
    X64_OP(REL8)    = 1 << 21,
    X64_OP(REL32)   = 1 << 22,
    X64_OP_REG(0)   = 1 << 23,
    X64_OP_REG(1)   = 1 << 24,
    X64_OP_REG(2)   = 1 << 25,
    X64_OP_REG(3)   = 1 << 26,
    X64_OP_REG(4)   = 1 << 27,
    X64_OP_REG(5)   = 1 << 28,
    X64_OP_REG(6)   = 1 << 29,
    X64_OP_REG(7)   = 1 << 30,
    X64_LABEL       = UINT32_MAX,
    X64_OP_REG(_)   = 0,
    X64_END         = 0
} x64_op_reg;

inline int32_t x64_op_reg_mask(void) {
    return X64_OP(R8) | X64_OP(R16) | X64_OP(R32) | X64_OP(R64) | X64_OP(XMM) | X64_OP(MM);
}

inline int32_t x64_op_mem_mask(void) {
    return X64_OP(M8) | X64_OP(M16) | X64_OP(M32) | X64_OP(M64) | X64_OP(M128);
}

inline int32_t x64_op_imm_mask(void) {
    return X64_OP(I8) | X64_OP(I16) | X64_OP(I32) | X64_OP(I64);
}

inline int32_t x64_op_rel_mask(void) {
    return X64_OP(REL8) | X64_OP(REL32);
}

inline int32_t x64_op_reg_id_mask(void) {
    return X64_OP_REG(1) | X64_OP_REG(2) | X64_OP_REG(3) | X64_OP_REG(4) | X64_OP_REG(5) |
        X64_OP_REG(6) | X64_OP_REG(7);
}

inline int32_t x64_op_label_mask(void) {
    return X64_OP(DSP8) | X64_OP(DSP32) | X64_OP(REL8) | X64_OP(REL32);
}

uint8_t x64_op_byte_size(x64_op_reg op);

int8_t x64_op_scale_bits(x64_op_reg op);

uint8_t x64_scale_bits_to_size(int8_t bits);

#define X64_OP_REG_MAX_BIT 30

const char *x64_op_reg_str(int32_t bit_idx);

#define X64_PFX(NAME) X64_PFX_##NAME

#define X64_FLAG(NAME) X64_FLAG_##NAME

#define X64_PFX_FLAG(NAME) X64_PFX_FLAG_##NAME

typedef enum [[gnu::packed]] {
    X64_PFX(LOCK)           = 1 << 0,
    X64_PFX(REP)            = 1 << 1,
    X64_PFX(REPNZ)          = 1 << 2,
    X64_PFX(REPNE)          = 1 << 3,
    X64_PFX(REPZ)           = 1 << 4,
    X64_PFX(REPE)           = 1 << 5,
    X64_PFX(OPERNAD)        = 1 << 6,
    X64_FLAG(PREFIX)        = 1 << 7,
    X64_FLAG(REX)           = 1 << 8,
    X64_FLAG(0F)            = 1 << 9,
    X64_FLAG(PLUSR)         = 1 << 10,
    X64_FLAG(OPCODE)        = 1 << 11,
    X64_FLAG(MODRRM)        = 1 << 12,
    X64_FLAG(INVALID)       = 1 << 13,
    X64_FLAG(DISASSEMBLER)  = 1 << 14,
    X64_FLAG(END)           = 1 << 15,
    X64_PFX_FLAG(_)         = 0
} x64_pfx_flag;

#define X64_PFX_FLAG_MAX_BIT 15

const char *x64_pfx_flag_str(int32_t bit_idx);

#define X64_REG(NAME) X64_REG_##NAME

typedef enum [[gnu::packed]] {
    X64_REG(RAX),
    X64_REG(RCX),
    X64_REG(RDX),
    X64_REG(RBX),
    X64_REG(RSP),
    X64_REG(RBP),
    X64_REG(RDI),
    X64_REG(RSI),
    X64_REG(R8),
    X64_REG(R9),
    X64_REG(R10),
    X64_REG(R11),
    X64_REG(R12),
    X64_REG(R13),
    X64_REG(R14),
    X64_REG(R15),
    X64_REG(XMM0),
    X64_REG(XMM1),
    X64_REG(XMM2),
    X64_REG(XMM3),
    X64_REG(XMM4),
    X64_REG(XMM5),
    X64_REG(XMM6),
    X64_REG(XMM7),
    X64_REG(XMM8),
    X64_REG(XMM9),
    X64_REG(XMM10),
    X64_REG(XMM11),
    X64_REG(XMM12),
    X64_REG(XMM13),
    X64_REG(XMM14),
    X64_REG(XMM15),
    X64_REG(MM0),
    X64_REG(MM1),
    X64_REG(MM2),
    X64_REG(MM3),
    X64_REG(MM4),
    X64_REG(MM5),
    X64_REG(MM6),
    X64_REG(MM7),
    X64_REG(RIP),
    X64_REG(_)
} x64_reg;

inline int8_t x64_reg_id(x64_reg reg) {
    return reg == X64_REG(RIP) ? 5 : reg & 7;
}

inline bool x64_reg_is_upper(x64_reg reg) {
    return (reg >= X64_REG(R8) && reg <= X64_REG(R15)) || (reg >= X64_REG(XMM8) && reg <= X64_REG(XMM15));
}

inline bool x64_reg_is_general(x64_reg reg) {
    return reg <= X64_REG(R15) || reg == X64_REG(RIP);
}

inline bool x64_reg_is_xmm(x64_reg reg) {
    return reg >= X64_REG(XMM0) && reg <= X64_REG(XMM15);
}

inline bool x64_reg_is_mm(x64_reg reg) {
    return reg >= X64_REG(MM0) && reg <= X64_REG(MM7);
}

#define X64_REX(NAME) X64_REX_##NAME

typedef enum [[gnu::packed]] {
    X64_REX(B)      = 1 << 0,
    X64_REX(X)      = 1 << 1,
    X64_REX(R)      = 1 << 2,
    X64_REX(W)      = 1 << 3,
    X64_REX(REX)    = 0
} x64_rex;

#define X64_MODSIB(NAME) X64_MODSIB_##NAME

typedef enum [[gnu::packed]] {
    X64_MODSIB(00)  = 0,
    X64_MODSIB(01)  = 1 << 0,
    X64_MODSIB(10)  = 1 << 1,
    X64_MODSIB(11)  = 1 << 1 | 1 << 0
} x64_modsib;

#define X64_SIB 5

const char *x64_reg_str(x64_reg reg);

#define X64_MNE(NAME) X64_MNE_##NAME

#define X64_MNE_PFX(NAME) X64_MNE_PFX_##NAME

#define X64_MNE_REX(NAME) X64_MNE_REX_##NAME

#define X64_MNE_INST(NAME) X64_MNE_INST_##NAME

typedef enum [[gnu::packed]] {
    X64_MNE(INVALID),
    X64_MNE(0F),
    X64_MNE_PFX(64NULL),
    X64_MNE_PFX(OPERAND_SIZE),
    X64_MNE_PFX(WAIT),
    X64_MNE_PFX(LOCK),
    X64_MNE_PFX(REPNZ),
    X64_MNE_PFX(REPNE),
    X64_MNE_PFX(REP),
    X64_MNE_PFX(REPZ),
    X64_MNE_PFX(REPE),
    X64_MNE_PFX(_),
    X64_MNE_REX(REX),
    X64_MNE_REX(REX_B),
    X64_MNE_REX(REX_X),
    X64_MNE_REX(REX_XB),
    X64_MNE_REX(REX_R),
    X64_MNE_REX(REX_RB),
    X64_MNE_REX(REX_RX),
    X64_MNE_REX(REX_RXB),
    X64_MNE_REX(REX_W),
    X64_MNE_REX(REX_WB),
    X64_MNE_REX(REX_WX),
    X64_MNE_REX(REX_WXB),
    X64_MNE_REX(REX_WR),
    X64_MNE_REX(REX_WRB),
    X64_MNE_REX(REX_WRX),
    X64_MNE_REX(REX_WRXB),
    X64_MNE_REX(_),
    X64_MNE_INST(ADD),
    X64_MNE_INST(OR),
    X64_MNE_INST(ADC),
    X64_MNE_INST(SBB),
    X64_MNE_INST(AND),
    X64_MNE_INST(SUB),
    X64_MNE_INST(XOR),
    X64_MNE_INST(CMP),
    X64_MNE_INST(PUSH),
    X64_MNE_INST(POP),
    X64_MNE_INST(MOVSXD),
    X64_MNE_INST(IMUL),
    X64_MNE_INST(INS),
    X64_MNE_INST(OUTS),
    X64_MNE_INST(JO),
    X64_MNE_INST(JNO),
    X64_MNE_INST(JB),
    X64_MNE_INST(JNAE),
    X64_MNE_INST(JC),
    X64_MNE_INST(JNB),
    X64_MNE_INST(JAE),
    X64_MNE_INST(JNC),
    X64_MNE_INST(JZ),
    X64_MNE_INST(JE),
    X64_MNE_INST(JNZ),
    X64_MNE_INST(JNE),
    X64_MNE_INST(JBE),
    X64_MNE_INST(JNA),
    X64_MNE_INST(JNBE),
    X64_MNE_INST(JA),
    X64_MNE_INST(JS),
    X64_MNE_INST(JNS),
    X64_MNE_INST(JP),
    X64_MNE_INST(JPE),
    X64_MNE_INST(JNP),
    X64_MNE_INST(JPO),
    X64_MNE_INST(JL),
    X64_MNE_INST(JNGE),
    X64_MNE_INST(JNL),
    X64_MNE_INST(JGE),
    X64_MNE_INST(JLE),
    X64_MNE_INST(JNG),
    X64_MNE_INST(JNLE),
    X64_MNE_INST(JG),
    X64_MNE_INST(TEST),
    X64_MNE_INST(XCHG),
    X64_MNE_INST(MOV),
    X64_MNE_INST(LEA),
    X64_MNE_INST(NOP),
    X64_MNE_INST(PAUSE),
    X64_MNE_INST(CBW),
    X64_MNE_INST(CWDE),
    X64_MNE_INST(CDQE),
    X64_MNE_INST(CWD),
    X64_MNE_INST(CDQ),
    X64_MNE_INST(CQO),
    X64_MNE_INST(PUSHF),
    X64_MNE_INST(POPF),
    X64_MNE_INST(MOVS),
    X64_MNE_INST(CMPS),
    X64_MNE_INST(STOS),
    X64_MNE_INST(LODS),
    X64_MNE_INST(SCAS),
    X64_MNE_INST(ROL),
    X64_MNE_INST(ROR),
    X64_MNE_INST(RCL),
    X64_MNE_INST(RCR),
    X64_MNE_INST(SHL),
    X64_MNE_INST(SHR),
    X64_MNE_INST(SAL),
    X64_MNE_INST(SAR),
    X64_MNE_INST(RET),
    X64_MNE_INST(ENTER),
    X64_MNE_INST(LEAVE),
    X64_MNE_INST(RETF),
    X64_MNE_INST(INT3),
    X64_MNE_INST(INT),
    X64_MNE_INST(LOOPNZ),
    X64_MNE_INST(LOOPNE),
    X64_MNE_INST(LOOPZ),
    X64_MNE_INST(LOOPE),
    X64_MNE_INST(LOOP),
    X64_MNE_INST(JECXZ),
    X64_MNE_INST(JRCXZ),
    X64_MNE_INST(IN),
    X64_MNE_INST(OUT),
    X64_MNE_INST(CALL),
    X64_MNE_INST(JMP),
    X64_MNE_INST(INT1),
    X64_MNE_INST(HLT),
    X64_MNE_INST(CMC),
    X64_MNE_INST(NOT),
    X64_MNE_INST(NEG),
    X64_MNE_INST(MUL),
    X64_MNE_INST(DIV),
    X64_MNE_INST(IDIV),
    X64_MNE_INST(CLC),
    X64_MNE_INST(STC),
    X64_MNE_INST(CLI),
    X64_MNE_INST(STI),
    X64_MNE_INST(CLD),
    X64_MNE_INST(STD),
    X64_MNE_INST(INC),
    X64_MNE_INST(DEC),
    X64_MNE_INST(MOVUPS),
    X64_MNE_INST(MOVSS),
    X64_MNE_INST(MOVUPD),
    X64_MNE_INST(MOVSD),
    X64_MNE_INST(MOVHLPS),
    X64_MNE_INST(MOVLPS),
    X64_MNE_INST(MOVLPD),
    X64_MNE_INST(MOVDDUP),
    X64_MNE_INST(MOVSLDUP),
    X64_MNE_INST(UNPCKLPS),
    X64_MNE_INST(UNPCKLPD),
    X64_MNE_INST(UNPCKHPS),
    X64_MNE_INST(UNPCKHPD),
    X64_MNE_INST(MOVLHPS),
    X64_MNE_INST(MOVHPS),
    X64_MNE_INST(MOVHPD),
    X64_MNE_INST(MOVSHDUP),
    X64_MNE_INST(MOVAPS),
    X64_MNE_INST(MOVAPD),
    X64_MNE_INST(CVTPI2PS),
    X64_MNE_INST(CVTSI2SS),
    X64_MNE_INST(CVTPI2PD),
    X64_MNE_INST(CVTSI2SD),
    X64_MNE_INST(MOVNTPS),
    X64_MNE_INST(MOVNTPD),
    X64_MNE_INST(CVTTPS2PI),
    X64_MNE_INST(CVTTSS2SI),
    X64_MNE_INST(CVTTPD2PI),
    X64_MNE_INST(CVTTSD2SI),
    X64_MNE_INST(CVTPS2PI),
    X64_MNE_INST(CVTSS2SI),
    X64_MNE_INST(CVTPD2PI),
    X64_MNE_INST(CVTSD2SI),
    X64_MNE_INST(UCOMISS),
    X64_MNE_INST(UCOMISD),
    X64_MNE_INST(COMISS),
    X64_MNE_INST(COMISD),
    X64_MNE_INST(MOVBE),
    X64_MNE_INST(CRC32),
    X64_MNE_INST(ROUNDPS),
    X64_MNE_INST(ROUNDPD),
    X64_MNE_INST(ROUNDSS),
    X64_MNE_INST(ROUNDSD),
    X64_MNE_INST(BLENDPS),
    X64_MNE_INST(BLENDPD),
    X64_MNE_INST(PBLENDW),
    X64_MNE_INST(PALIGNR),
    X64_MNE_INST(PEXTRB),
    X64_MNE_INST(PEXTRW),
    X64_MNE_INST(PEXTRD),
    X64_MNE_INST(PEXTRQ),
    X64_MNE_INST(EXTRACTPS),
    X64_MNE_INST(PINSRB),
    X64_MNE_INST(INSERTPS),
    X64_MNE_INST(PINSRD),
    X64_MNE_INST(PINSRQ),
    X64_MNE_INST(DPPS),
    X64_MNE_INST(DPPD),
    X64_MNE_INST(MPSADBW),
    X64_MNE_INST(PCMPESTRM),
    X64_MNE_INST(PCMPESTRI),
    X64_MNE_INST(PCMPISTRM),
    X64_MNE_INST(PCMPISTRI),
    X64_MNE_INST(CMOVO),
    X64_MNE_INST(CMOVNO),
    X64_MNE_INST(CMOVB),
    X64_MNE_INST(CMOVNAE),
    X64_MNE_INST(CMOVC),
    X64_MNE_INST(CMOVNB),
    X64_MNE_INST(CMOVAE),
    X64_MNE_INST(CMOVNC),
    X64_MNE_INST(CMOVZ),
    X64_MNE_INST(CMOVE),
    X64_MNE_INST(CMOVNZ),
    X64_MNE_INST(CMOVNE),
    X64_MNE_INST(CMOVBE),
    X64_MNE_INST(CMOVNA),
    X64_MNE_INST(CMOVNBE),
    X64_MNE_INST(CMOVA),
    X64_MNE_INST(CMOVS),
    X64_MNE_INST(CMOVNS),
    X64_MNE_INST(CMOVP),
    X64_MNE_INST(CMOVPE),
    X64_MNE_INST(CMOVNP),
    X64_MNE_INST(CMOVPO),
    X64_MNE_INST(CMOVL),
    X64_MNE_INST(CMOVNGE),
    X64_MNE_INST(CMOVNL),
    X64_MNE_INST(CMOVGE),
    X64_MNE_INST(CMOVLE),
    X64_MNE_INST(CMOVNG),
    X64_MNE_INST(CMOVNLE),
    X64_MNE_INST(CMOVG),
    X64_MNE_INST(MOVMSKPS),
    X64_MNE_INST(MOVMSKPD),
    X64_MNE_INST(SQRTPS),
    X64_MNE_INST(SQRTSS),
    X64_MNE_INST(SQRTPD),
    X64_MNE_INST(SQRTSD),
    X64_MNE_INST(RSQRTPS),
    X64_MNE_INST(RSQRTSS),
    X64_MNE_INST(RCPPS),
    X64_MNE_INST(RCPSS),
    X64_MNE_INST(ANDPS),
    X64_MNE_INST(ANDPD),
    X64_MNE_INST(ANDNPS),
    X64_MNE_INST(ANDNPD),
    X64_MNE_INST(ORPS),
    X64_MNE_INST(ORPD),
    X64_MNE_INST(XORPS),
    X64_MNE_INST(XORPD),
    X64_MNE_INST(ADDPS),
    X64_MNE_INST(ADDSS),
    X64_MNE_INST(ADDPD),
    X64_MNE_INST(ADDSD),
    X64_MNE_INST(MULPS),
    X64_MNE_INST(MULSS),
    X64_MNE_INST(MULPD),
    X64_MNE_INST(MULSD),
    X64_MNE_INST(CVTPS2PD),
    X64_MNE_INST(CVTPD2PS),
    X64_MNE_INST(CVTSS2SD),
    X64_MNE_INST(CVTSD2SS),
    X64_MNE_INST(CVTDQ2PS),
    X64_MNE_INST(CVTPS2DQ),
    X64_MNE_INST(CVTTPS2DQ),
    X64_MNE_INST(SUBPS),
    X64_MNE_INST(SUBSS),
    X64_MNE_INST(SUBPD),
    X64_MNE_INST(SUBSD),
    X64_MNE_INST(MINPS),
    X64_MNE_INST(MINSS),
    X64_MNE_INST(MINPD),
    X64_MNE_INST(MINSD),
    X64_MNE_INST(DIVPS),
    X64_MNE_INST(DIVSS),
    X64_MNE_INST(DIVPD),
    X64_MNE_INST(DIVSD),
    X64_MNE_INST(MAXPS),
    X64_MNE_INST(MAXSS),
    X64_MNE_INST(MAXPD),
    X64_MNE_INST(MAXSD),
    X64_MNE_INST(PUNPCKLBW),
    X64_MNE_INST(PUNPCKLWD),
    X64_MNE_INST(PUNPCKLDQ),
    X64_MNE_INST(PACKSSWB),
    X64_MNE_INST(PCMPGTB),
    X64_MNE_INST(PCMPGTW),
    X64_MNE_INST(PCMPGTD),
    X64_MNE_INST(PACKUSWB),
    X64_MNE_INST(PUNPCKHBW),
    X64_MNE_INST(PUNPCKHWD),
    X64_MNE_INST(PUNPCKHDQ),
    X64_MNE_INST(PACKSSDW),
    X64_MNE_INST(PUNPCKLQDQ),
    X64_MNE_INST(PUNPCKHQDQ),
    X64_MNE_INST(MOVD),
    X64_MNE_INST(MOVQ),
    X64_MNE_INST(MOVDQA),
    X64_MNE_INST(MOVDQU),
    X64_MNE_INST(PSHUFW),
    X64_MNE_INST(PSHUFLW),
    X64_MNE_INST(PSHUFHW),
    X64_MNE_INST(PSHUFD),
    X64_MNE_INST(PSRLW),
    X64_MNE_INST(PSRAW),
    X64_MNE_INST(PSLLW),
    X64_MNE_INST(PSRLD),
    X64_MNE_INST(PSRAD),
    X64_MNE_INST(PSLLD),
    X64_MNE_INST(PSRLQ),
    X64_MNE_INST(PSRLDQ),
    X64_MNE_INST(PSLLQ),
    X64_MNE_INST(PSLLDQ),
    X64_MNE_INST(PCMPEQB),
    X64_MNE_INST(PCMPEQW),
    X64_MNE_INST(PCMPEQD),
    X64_MNE_INST(EMMS),
    X64_MNE_INST(HADDPD),
    X64_MNE_INST(HADDPS),
    X64_MNE_INST(HSUBPD),
    X64_MNE_INST(HSUBPS),
    X64_MNE_INST(SETO),
    X64_MNE_INST(SETNO),
    X64_MNE_INST(SETB),
    X64_MNE_INST(SETNAE),
    X64_MNE_INST(SETC),
    X64_MNE_INST(SETNB),
    X64_MNE_INST(SETAE),
    X64_MNE_INST(SETNC),
    X64_MNE_INST(SETZ),
    X64_MNE_INST(SETE),
    X64_MNE_INST(SETNZ),
    X64_MNE_INST(SETNE),
    X64_MNE_INST(SETBE),
    X64_MNE_INST(SETNA),
    X64_MNE_INST(SETNBE),
    X64_MNE_INST(SETA),
    X64_MNE_INST(SETS),
    X64_MNE_INST(SETNS),
    X64_MNE_INST(SETP),
    X64_MNE_INST(SETPE),
    X64_MNE_INST(SETNP),
    X64_MNE_INST(SETPO),
    X64_MNE_INST(SETL),
    X64_MNE_INST(SETNGE),
    X64_MNE_INST(SETNL),
    X64_MNE_INST(SETGE),
    X64_MNE_INST(SETLE),
    X64_MNE_INST(SETNG),
    X64_MNE_INST(SETNLE),
    X64_MNE_INST(SETG),
    X64_MNE_INST(BT),
    X64_MNE_INST(SHLD),
    X64_MNE_INST(BTS),
    X64_MNE_INST(SHRD),
    X64_MNE_INST(CMPXCHG),
    X64_MNE_INST(BTR),
    X64_MNE_INST(MOVZX),
    X64_MNE_INST(POPCNT),
    X64_MNE_INST(BTC),
    X64_MNE_INST(BSE),
    X64_MNE_INST(BSF),
    X64_MNE_INST(BSR),
    X64_MNE_INST(MOVSX),
    X64_MNE_INST(XADD),
    X64_MNE_INST(CMPPS),
    X64_MNE_INST(CMPSS),
    X64_MNE_INST(CMPPD),
    X64_MNE_INST(CMPSD),
    X64_MNE_INST(MOVNTI),
    X64_MNE_INST(PINSRW),
    X64_MNE_INST(SHUFPS),
    X64_MNE_INST(SHUFPD),
    X64_MNE_INST(CMPXCHG8B),
    X64_MNE_INST(CMPXCHG16B),
    X64_MNE_INST(BSWAP),
    X64_MNE_INST(ADDSUBPD),
    X64_MNE_INST(ADDSUBPS),
    X64_MNE_INST(PADDQ),
    X64_MNE_INST(PMULLW),
    X64_MNE_INST(MOVQ2DQ),
    X64_MNE_INST(MOVDQ2Q),
    X64_MNE_INST(PMOVMSKB),
    X64_MNE_INST(PSUBUSB),
    X64_MNE_INST(PSUBUSW),
    X64_MNE_INST(PMINUB),
    X64_MNE_INST(PAND),
    X64_MNE_INST(PADDUSB),
    X64_MNE_INST(PADDUSW),
    X64_MNE_INST(PMAXUB),
    X64_MNE_INST(PANDN),
    X64_MNE_INST(PAVGB),
    X64_MNE_INST(PAVGW),
    X64_MNE_INST(PMULHUW),
    X64_MNE_INST(PMULHW),
    X64_MNE_INST(CVTPD2DQ),
    X64_MNE_INST(CVTTPD2DQ),
    X64_MNE_INST(CVTDQ2PD),
    X64_MNE_INST(MOVNTQ),
    X64_MNE_INST(MOVNTDQ),
    X64_MNE_INST(PSUBSB),
    X64_MNE_INST(PSUBSW),
    X64_MNE_INST(PMINSW),
    X64_MNE_INST(POR),
    X64_MNE_INST(PADDSB),
    X64_MNE_INST(PADDSW),
    X64_MNE_INST(PMAXSW),
    X64_MNE_INST(PXOR),
    X64_MNE_INST(LDDQU),
    X64_MNE_INST(PMULUDQ),
    X64_MNE_INST(PMADDWD),
    X64_MNE_INST(PSADBW),
    X64_MNE_INST(MASKMOVQ),
    X64_MNE_INST(MASKMOVDQU),
    X64_MNE_INST(PSUBB),
    X64_MNE_INST(PSUBW),
    X64_MNE_INST(PSUBD),
    X64_MNE_INST(PSUBQ),
    X64_MNE_INST(PADDB),
    X64_MNE_INST(PADDW),
    X64_MNE_INST(PADDD),
    X64_MNE_INST(_)
} x64_mne;

const char *x64_mne_str(x64_mne mne);
